yuehui@master:~$ ssh gmaster 
Welcome to Ubuntu 16.04.3 LTS (GNU/Linux 4.13.0-1012-gcp x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

78 packages can be updated.
0 updates are security updates.


Last login: Fri Apr 13 05:31:59 2018 from 36.149.129.137
yuehui@master:~$ cd sh
yuehui@master:~/sh$ sh start.sh 
Starting namenodes on [master]
master: starting namenode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-namenode-master.out
master: 18/04/14 04:04:40 INFO namenode.NameNode: STARTUP_MSG: 
master: /************************************************************
master: STARTUP_MSG: Starting NameNode
master: STARTUP_MSG:   host = master/10.140.0.2
master: STARTUP_MSG:   args = []                                                                                                                                                                                                             
master: STARTUP_MSG:   version = 2.7.5                                                                                                                                                                                                       
master: STARTUP_MSG:   classpath = /usr/local/soft/hadoop/etc/hadoop:/usr/local/soft/hadoop/share/hadoop/common/lib/java-xmlbuilder-0.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jets3t-0.9.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-i18n-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-api-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-framework-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpcore-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-kerberos-codec-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-math3-3.1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-digester-1.8.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-core-1.8.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-sslengine-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpclient-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-net-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-auth-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-1.7.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsp-api-2.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/mockito-all-1.8.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsch-0.1.54.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/gson-2.2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-httpclient-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-util-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-configuration-1.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-asn1-api-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-recipes-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-client-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xercesImpl-2.9.1.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-daemon-1.0.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-all-4.0.23.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xml-apis-1.3.04.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-client-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6-tests.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-sharedcachemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-resourcemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-client-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-unmanaged-am-launcher-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-nodemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-api-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-distributedshell-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-registry-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-web-proxy-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-tests-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-applicationhistoryservice-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-plugins-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-core-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-shuffle-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-app-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-2.7.5.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar
master: STARTUP_MSG:   build = https://shv@git-wip-us.apache.org/repos/asf/hadoop.git -r 18065c2b6806ed4aa6a3187d77cbe21bb3dba075; compiled by 'kshvachk' on 2017-12-16T01:06Z
master: STARTUP_MSG:   java = 1.8.0_152
master: ************************************************************/
master: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-master.out
slave1: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-slave1.out
slave4: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-slave4.out
slave3: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-slave3.out
slave5: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-slave5.out
master: 18/04/14 04:04:45 INFO datanode.DataNode: STARTUP_MSG: 
master: /************************************************************
master: STARTUP_MSG: Starting DataNode
master: STARTUP_MSG:   host = master/10.140.0.2
master: STARTUP_MSG:   args = []
master: STARTUP_MSG:   version = 2.7.5
master: STARTUP_MSG:   classpath = /usr/local/soft/hadoop/etc/hadoop:/usr/local/soft/hadoop/share/hadoop/common/lib/java-xmlbuilder-0.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jets3t-0.9.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-i18n-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-api-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-framework-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpcore-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-kerberos-codec-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-math3-3.1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-digester-1.8.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-core-1.8.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-sslengine-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpclient-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-net-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-auth-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-1.7.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsp-api-2.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/mockito-all-1.8.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsch-0.1.54.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/gson-2.2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-httpclient-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-util-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-configuration-1.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-asn1-api-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-recipes-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-client-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xercesImpl-2.9.1.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-daemon-1.0.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-all-4.0.23.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xml-apis-1.3.04.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-client-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6-tests.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-sharedcachemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-resourcemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-client-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-unmanaged-am-launcher-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-nodemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-api-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-distributedshell-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-registry-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-web-proxy-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-tests-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-applicationhistoryservice-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-plugins-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-core-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-shuffle-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-app-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-2.7.5.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar
master: STARTUP_MSG:   build = https://shv@git-wip-us.apache.org/repos/asf/hadoop.git -r 18065c2b6806ed4aa6a3187d77cbe21bb3dba075; compiled by 'kshvachk' on 2017-12-16T01:06Z
master: STARTUP_MSG:   java = 1.8.0_152
master: ************************************************************/
slave2: starting datanode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-datanode-slave2.out
Starting secondary namenodes [master]
master: starting secondarynamenode, logging to /usr/local/soft/hadoop/logs/hadoop-yuehui-secondarynamenode-master.out
master: 18/04/14 04:04:51 INFO namenode.SecondaryNameNode: STARTUP_MSG: 
master: /************************************************************
master: STARTUP_MSG: Starting SecondaryNameNode
master: STARTUP_MSG:   host = master/10.140.0.2
master: STARTUP_MSG:   args = []
master: STARTUP_MSG:   version = 2.7.5
master: STARTUP_MSG:   classpath = /usr/local/soft/hadoop/etc/hadoop:/usr/local/soft/hadoop/share/hadoop/common/lib/java-xmlbuilder-0.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jets3t-0.9.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-i18n-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-api-1.7.10.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-framework-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpcore-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/apacheds-kerberos-codec-2.0.0-M15.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-math3-3.1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-digester-1.8.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-core-1.8.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-sslengine-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/httpclient-4.2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-net-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/hadoop-auth-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-beanutils-1.7.0.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsp-api-2.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/mockito-all-1.8.5.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jsch-0.1.54.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/gson-2.2.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-httpclient-3.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-util-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-configuration-1.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/api-asn1-api-1.0.0-M20.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-recipes-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/curator-client-2.7.1.jar:/usr/local/soft/hadoop/share/hadoop/common/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/common/hadoop-common-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/htrace-core-3.1.0-incubating.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xmlenc-0.52.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xercesImpl-2.9.1.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-daemon-1.0.13.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/netty-all-4.0.23.Final.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/xml-apis-1.3.04.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-nfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/hdfs/hadoop-hdfs-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-collections-3.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jettison-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-api-2.2.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-codec-1.4.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-client-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jsr305-3.0.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/servlet-api-2.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jetty-util-6.1.26.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6-tests.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/guava-11.0.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/activation-1.1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-cli-1.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-logging-1.1.3.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jersey-json-1.9.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jaxb-impl-2.2.3-1.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-jaxrs-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/commons-lang-2.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/jackson-xc-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/zookeeper-3.4.6.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/stax-api-1.0-2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-sharedcachemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-resourcemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-client-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-unmanaged-am-launcher-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-nodemanager-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-api-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-applications-distributedshell-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-registry-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-web-proxy-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-tests-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/yarn/hadoop-yarn-server-applicationhistoryservice-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/aopalliance-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-guice-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/javax.inject-1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/log4j-1.2.17.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-compress-1.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/commons-io-2.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/netty-3.6.2.Final.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/protobuf-java-2.5.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/snappy-java-1.0.4.1.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/leveldbjni-all-1.8.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hadoop-annotations-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-server-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-mapper-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/paranamer-2.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jersey-core-1.9.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/junit-4.11.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/xz-1.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/hamcrest-core-1.3.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/jackson-core-asl-1.9.13.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/guice-servlet-3.0.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/avro-1.7.4.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/lib/asm-3.2.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-plugins-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-common-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-core-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-examples-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5-tests.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-shuffle-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-app-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-jobclient-2.7.5.jar:/usr/local/soft/hadoop/share/hadoop/mapreduce/hadoop-mapreduce-client-hs-2.7.5.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar:/usr/local/soft/hadoop/contrib/capacity-scheduler/*.jar
master: STARTUP_MSG:   build = https://shv@git-wip-us.apache.org/repos/asf/hadoop.git -r 18065c2b6806ed4aa6a3187d77cbe21bb3dba075; compiled by 'kshvachk' on 2017-12-16T01:06Z
master: STARTUP_MSG:   java = 1.8.0_152
master: ************************************************************/
starting yarn daemons
starting resourcemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-resourcemanager-master.out
slave1: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-slave1.out
slave4: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-slave4.out
slave5: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-slave5.out
master: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-master.out
slave3: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-slave3.out
slave2: starting nodemanager, logging to /usr/local/soft/hadoop/logs/yarn-yuehui-nodemanager-slave2.out
starting historyserver, logging to /usr/local/soft/hadoop/logs/mapred-yuehui-historyserver-master.out
starting org.apache.spark.deploy.master.Master, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.master.Master-1-master.out
slave1: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.worker.Worker-1-slave1.out
slave2: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.worker.Worker-1-slave2.out
slave5: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.worker.Worker-1-slave5.out
slave3: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.worker.Worker-1-slave3.out
slave4: starting org.apache.spark.deploy.worker.Worker, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.worker.Worker-1-slave4.out
starting org.apache.spark.deploy.history.HistoryServer, logging to /usr/local/soft/spark/logs/spark-yuehui-org.apache.spark.deploy.history.HistoryServer-1-master.out
yuehui@master:~/sh$ spark-shell  --master spark://master:7077 --deploy-mode client --total-executor-cores 20  --executor-memory 15G  --executor-cores 1  --driver-memory 36G 
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/local/soft/spark/jars/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/local/soft/hadoop/share/hadoop/common/lib/slf4j-log4j12-1.7.10.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
2018-04-14 04:05:55 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
Spark context Web UI available at http://master:4040
Spark context available as 'sc' (master = spark://master:7077, app id = app-20180414040604-0000).
Spark session available as 'spark'.
Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.3.0
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_152)
Type in expressions to have them evaluated.
Type :help for more information.

scala> import org.apache.spark.mllib.fpm.FPGrowth
import org.apache.spark.mllib.fpm.FPGrowth

scala> import org.apache.spark.rdd.RDD
import org.apache.spark.rdd.RDD

scala> 

scala> //最小支持度

scala> val minSupport = 0.100
minSupport: Double = 0.1

scala> //最小置信度

scala> val minConfidence = 0.80
minConfidence: Double = 0.8

scala> //数据分区数

scala> val numPartitions = 360
numPartitions: Int = 360

scala> //hdfs input url 

scala> val inputUrl = "hdfs://master:9000/data/"
inputUrl: String = hdfs://master:9000/data/

scala> //hdfs out url 

scala> val outputUrl = "hdfs://master:9000/out/0414_360/"
outputUrl: String = hdfs://master:9000/out/0414_360/

scala> //读取数据

scala> val data = sc.textFile(inputUrl + "D.dat",numPartitions)
data: org.apache.spark.rdd.RDD[String] = hdfs://master:9000/data/D.dat MapPartitionsRDD[1] at textFile at <console>:30

scala> val user = sc.textFile(inputUrl + "U.dat",numPartitions)
user: org.apache.spark.rdd.RDD[String] = hdfs://master:9000/data/U.dat MapPartitionsRDD[3] at textFile at <console>:30

scala> //转换为Int数组，并去重，更节省内存空间

scala> val transactions = data.map(line => line.trim.split(" ").map(_.toInt).distinct)
transactions: org.apache.spark.rdd.RDD[Array[Int]] = MapPartitionsRDD[4] at map at <console>:27

scala> transactions.cache()
res0: transactions.type = MapPartitionsRDD[4] at map at <console>:27

scala> //用户购买记录Array

scala> val userArray = user.map(line => line.trim.split(" ").map(_.toInt).distinct)
userArray: org.apache.spark.rdd.RDD[Array[Int]] = MapPartitionsRDD[5] at map at <console>:27

scala> userArray.cache()
res1: userArray.type = MapPartitionsRDD[5] at map at <console>:27

scala> val usrSet = userArray.map(_.toSet)
usrSet: org.apache.spark.rdd.RDD[scala.collection.immutable.Set[Int]] = MapPartitionsRDD[6] at map at <console>:27

scala> 

scala> //创建一个FPGrowth的算法实列,设置计算的最小支持度和数据分区

scala> val fpg = new FPGrowth().setMinSupport(minSupport).setNumPartitions(numPartitions)
fpg: org.apache.spark.mllib.fpm.FPGrowth = org.apache.spark.mllib.fpm.FPGrowth@5344b208

scala> //获得FPGrowth计算结果

scala> val model = fpg.run(transactions)
[Stage 0:===================================================>  (343 + 19) / 360]2018-04-14 04:06:54 WARN  TaskSetManager:66 - Lost task 324.1 in stage 0.0 (TID 360, 10.140.0.7, executor 6): TaskKilled (another attempt succeeded)
2018-04-14 04:06:54 WARN  TaskSetManager:66 - Lost task 328.1 in stage 0.0 (TID 361, 10.140.0.5, executor 12): TaskKilled (another attempt succeeded)
model: org.apache.spark.mllib.fpm.FPGrowthModel[Int] = org.apache.spark.mllib.fpm.FPGrowthModel@9b5ff2e

scala> //收集频繁项集

scala> val fre = model.freqItemsets.map(itemset => (itemset.freq, itemset.items))
fre: org.apache.spark.rdd.RDD[(Long, Array[Int])] = MapPartitionsRDD[15] at map at <console>:27

scala> fre.cache()
res2: fre.type = MapPartitionsRDD[15] at map at <console>:27

scala> 

scala> //频繁项集升序排序

scala> val freq = fre.sortByKey().collect
[Stage 4:===================================================>  (343 + 20) / 360]2018-04-14 06:24:29 WARN  TaskSetManager:66 - Lost task 241.1 in stage 4.0 (TID 1802, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 4:===================================================>  (344 + 20) / 360]2018-04-14 06:25:21 WARN  TaskSetManager:66 - Lost task 243.1 in stage 4.0 (TID 1805, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 4:===================================================>  (344 + 20) / 360]2018-04-14 06:26:07 WARN  TaskSetManager:66 - Lost task 250.1 in stage 4.0 (TID 1807, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 4:===================================================>  (346 + 20) / 360]2018-04-14 06:26:36 WARN  TaskSetManager:66 - Lost task 246.1 in stage 4.0 (TID 1803, 10.140.0.3, executor 1): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (347 + 19) / 360]2018-04-14 06:27:25 WARN  TaskSetManager:66 - Lost task 248.1 in stage 4.0 (TID 1806, 10.140.0.8, executor 17): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (348 + 17) / 360]2018-04-14 06:27:38 WARN  TaskSetManager:66 - Lost task 247.1 in stage 4.0 (TID 1804, 10.140.0.8, executor 19): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (350 + 14) / 360]2018-04-14 06:28:08 WARN  TaskSetManager:66 - Lost task 249.1 in stage 4.0 (TID 1810, 10.140.0.5, executor 15): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (351 + 12) / 360]2018-04-14 06:28:16 WARN  TaskSetManager:66 - Lost task 253.1 in stage 4.0 (TID 1811, 10.140.0.3, executor 1): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (352 + 14) / 360]2018-04-14 06:29:38 WARN  TaskSetManager:66 - Lost task 252.1 in stage 4.0 (TID 1809, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 4:====================================================> (353 + 12) / 360]2018-04-14 06:29:54 WARN  TaskSetManager:66 - Lost task 251.1 in stage 4.0 (TID 1808, 10.140.0.4, executor 10): TaskKilled (another attempt succeeded)
[Stage 4:=====================================================>(354 + 13) / 360]2018-04-14 06:32:18 WARN  TaskSetManager:66 - Lost task 257.1 in stage 4.0 (TID 1814, 10.140.0.7, executor 5): TaskKilled (another attempt succeeded)
[Stage 4:=====================================================>(356 + 10) / 360]2018-04-14 06:32:33 WARN  TaskSetManager:66 - Lost task 261.1 in stage 4.0 (TID 1818, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 4:======================================================>(357 + 8) / 360]2018-04-14 06:32:42 WARN  TaskSetManager:66 - Lost task 254.1 in stage 4.0 (TID 1812, 10.140.0.8, executor 17): TaskKilled (another attempt succeeded)
[Stage 4:======================================================>(357 + 7) / 360]2018-04-14 06:32:43 WARN  TaskSetManager:66 - Lost task 258.1 in stage 4.0 (TID 1815, 10.140.0.5, executor 12): TaskKilled (another attempt succeeded)
[Stage 4:======================================================>(358 + 5) / 360]2018-04-14 06:33:07 WARN  TaskSetManager:66 - Lost task 259.1 in stage 4.0 (TID 1816, 10.140.0.3, executor 1): TaskKilled (another attempt succeeded)
[Stage 4:======================================================>(359 + 3) / 360]2018-04-14 06:33:58 WARN  TaskSetManager:66 - Lost task 255.1 in stage 4.0 (TID 1813, 10.140.0.5, executor 13): TaskKilled (another attempt succeeded)
[Stage 6:=======================================================> (33 + 0) / 34]2018-04-14 06:34:58 WARN  TaskSetManager:66 - Lost task 260.1 in stage 4.0 (TID 1817, 10.140.0.3, executor 2): TaskKilled (another attempt succeeded)
freq: Array[(Long, Array[Int])] = Array((169209,Array(20, 6, 81, 121, 516, 8, 122)), (169209,Array(20, 60, 878, 51, 171, 124, 122)), (169209,Array(524, 60, 51, 171, 124)), (169209,Array(519, 379, 60, 51, 516, 49, 122)), (169209,Array(519, 123, 121, 124, 49)), (169209,Array(514, 158, 121, 516, 124, 122)), (169209,Array(123, 146, 121, 51, 171, 122)), (169209,Array(123, 469, 81, 121, 51, 516, 122)), (169209,Array(469, 20, 22, 121, 124, 49, 122)), (169209,Array(140, 476, 60, 121, 124, 49, 8, 122)), (169209,Array(140, 158, 124, 8, 122)), (169210,Array(20, 514, 22, 84, 51, 516, 8)), (169210,Array(472, 60, 878, 124)), (169210,Array(361, 476, 51, 8)), (169210,Array(138, 469, 516, 49, 122)), (169210,Array(14, 511, 84, 60, 122)), (169210,Array(448, 81, 379, 516, 49, 8)), (169210,Array(275, 146, 5...
scala> 

scala> val resfreq = sc.makeRDD(freq.map(u => u._2.mkString(" ")))
resfreq: org.apache.spark.rdd.RDD[String] = ParallelCollectionRDD[22] at makeRDD at <console>:28

scala> resfreq.saveAsTextFile(outputUrl+"freqItemsets")
2018-04-14 06:35:03 WARN  TaskSetManager:66 - Stage 10 contains a task of very large size (457 KB). The maximum recommended task size is 100 KB.
                                                                                
scala> 

scala> //推荐规则[前项, (后项, 置信度)]

scala> val AllAssociationRules = model.generateAssociationRules(minConfidence).map(x => (x.antecedent.toSet, (x.consequent, x.confidence)))
AllAssociationRules: org.apache.spark.rdd.RDD[(scala.collection.immutable.Set[Int], (Array[Int], Double))] = MapPartitionsRDD[31] at map at <console>:29

scala> //根据前项聚合产生的规则 [前项，[(后项，置信度)]]

scala> //不知道combineByKey是否平均分配到每个分区.repartition(numPartitions)

scala> val rulesList =AllAssociationRules.combineByKey(List(_), (x:List[(Array[Int], Double)], y:(Array[Int], Double)) => y :: x, (x:List[(Array[Int], Double)], y:List[(Array[Int], Double)]) => x ::: y)
rulesList: org.apache.spark.rdd.RDD[(scala.collection.immutable.Set[Int], List[(Array[Int], Double)])] = ShuffledRDD[32] at combineByKey at <console>:27

scala> //保存关联规则与置信度[a,b] --> [ c : 0.9 ] | [ d : 0.8 ]

scala> rulesList.map(rule => (rule._1.mkString("[", ",", "]") + " --> " + rule._2.map(x => (x._1 + " : " + x._2.toString())).mkString("[ ", " | ", " ]"))).saveAsTextFile(outputUrl+"rulesList2") 
[Stage 12:============>(345 + 20) / 360][Stage 13:>               (0 + 0) / 360]2018-04-14 08:06:02 WARN  TaskSetManager:66 - Lost task 241.1 in stage 12.0 (TID 2946, 10.140.0.8, executor 17): TaskKilled (another attempt succeeded)
[Stage 12:============>(346 + 19) / 360][Stage 13:>              (11 + 1) / 360]2018-04-14 08:06:12 WARN  TaskSetManager:66 - Lost task 239.1 in stage 12.0 (TID 2943, 10.140.0.5, executor 13): TaskKilled (another attempt succeeded)
[Stage 12:============>(347 + 17) / 360][Stage 13:>              (18 + 3) / 360]2018-04-14 08:06:51 WARN  TaskSetManager:66 - Lost task 247.1 in stage 12.0 (TID 2960, 10.140.0.7, executor 4): TaskKilled (another attempt succeeded)
[Stage 12:============>(348 + 16) / 360][Stage 13:>              (19 + 4) / 360]2018-04-14 08:07:08 WARN  TaskSetManager:66 - Lost task 248.1 in stage 12.0 (TID 2945, 10.140.0.4, executor 9): TaskKilled (another attempt succeeded)
[Stage 12:============>(350 + 15) / 360][Stage 13:=>             (25 + 5) / 360]2018-04-14 08:08:08 WARN  TaskSetManager:66 - Lost task 249.1 in stage 12.0 (TID 2947, 10.140.0.5, executor 14): TaskKilled (another attempt succeeded)
[Stage 12:============>(351 + 14) / 360][Stage 13:=>             (26 + 6) / 360]2018-04-14 08:08:48 WARN  TaskSetManager:66 - Lost task 253.1 in stage 12.0 (TID 2975, 10.140.0.8, executor 17): TaskKilled (another attempt succeeded)
[Stage 12:============>(352 + 13) / 360][Stage 13:=>             (31 + 7) / 360]2018-04-14 08:09:27 WARN  TaskSetManager:66 - Lost task 251.1 in stage 12.0 (TID 2944, 10.140.0.3, executor 0): TaskKilled (another attempt succeeded)
[Stage 12:============>(353 + 13) / 360][Stage 13:=>             (36 + 7) / 360]2018-04-14 08:11:06 WARN  TaskSetManager:66 - Lost task 254.1 in stage 12.0 (TID 2976, 10.140.0.7, executor 4): TaskKilled (another attempt succeeded)
[Stage 12:============>(355 + 12) / 360][Stage 13:=>             (39 + 8) / 360]2018-04-14 08:12:36 WARN  TaskSetManager:66 - Lost task 252.1 in stage 12.0 (TID 2971, 10.140.0.5, executor 13): TaskKilled (another attempt succeeded)
[Stage 12:============>(355 + 11) / 360][Stage 13:=>             (39 + 9) / 360]2018-04-14 08:12:39 WARN  TaskSetManager:66 - Lost task 255.1 in stage 12.0 (TID 2983, 10.140.0.5, executor 12): TaskKilled (another attempt succeeded)
[Stage 12:=============>(356 + 9) / 360][Stage 13:=>            (40 + 11) / 360]2018-04-14 08:13:10 WARN  TaskSetManager:66 - Lost task 258.1 in stage 12.0 (TID 2993, 10.140.0.3, executor 3): TaskKilled (another attempt succeeded)
[Stage 12:=============>(357 + 7) / 360][Stage 13:=>            (42 + 13) / 360]2018-04-14 08:13:46 WARN  TaskSetManager:66 - Lost task 257.1 in stage 12.0 (TID 2989, 10.140.0.8, executor 16): TaskKilled (another attempt succeeded)
[Stage 12:=============>(358 + 5) / 360][Stage 13:=>            (44 + 15) / 360]2018-04-14 08:14:48 WARN  TaskSetManager:66 - Lost task 259.1 in stage 12.0 (TID 2994, 10.140.0.8, executor 17): TaskKilled (another attempt succeeded)
[Stage 12:=============>(359 + 3) / 360][Stage 13:=>            (47 + 17) / 360]2018-04-14 08:15:48 WARN  TaskSetManager:66 - Lost task 261.1 in stage 12.0 (TID 3001, 10.140.0.8, executor 18): TaskKilled (another attempt succeeded)
[Stage 13:========>                                             (56 + 19) / 360]2018-04-14 08:17:46 WARN  TaskSetManager:66 - Lost task 260.1 in stage 12.0 (TID 3000, 10.140.0.5, executor 14): TaskKilled (another attempt succeeded)
[Stage 13:==================================================>  (342 + 20) / 360]2018-04-14 09:42:07 WARN  TaskSetManager:66 - Lost task 239.1 in stage 13.0 (TID 3318, 10.140.0.7, executor 7): TaskKilled (another attempt succeeded)
[Stage 13:==================================================>  (344 + 20) / 360]2018-04-14 09:43:35 WARN  TaskSetManager:66 - Lost task 246.1 in stage 13.0 (TID 3321, 10.140.0.7, executor 6): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (347 + 19) / 360]2018-04-14 09:44:13 WARN  TaskSetManager:66 - Lost task 243.1 in stage 13.0 (TID 3324, 10.140.0.5, executor 15): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (347 + 18) / 360]2018-04-14 09:44:15 WARN  TaskSetManager:66 - Lost task 248.1 in stage 13.0 (TID 3319, 10.140.0.5, executor 12): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (350 + 17) / 360]2018-04-14 09:45:25 WARN  TaskSetManager:66 - Lost task 247.1 in stage 13.0 (TID 3325, 10.140.0.4, executor 11): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (350 + 16) / 360]2018-04-14 09:45:30 WARN  TaskSetManager:66 - Lost task 249.1 in stage 13.0 (TID 3320, 10.140.0.7, executor 7): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (351 + 15) / 360]2018-04-14 09:46:46 WARN  TaskSetManager:66 - Lost task 253.1 in stage 13.0 (TID 3326, 10.140.0.4, executor 10): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (352 + 13) / 360]2018-04-14 09:47:05 WARN  TaskSetManager:66 - Lost task 252.1 in stage 13.0 (TID 3323, 10.140.0.7, executor 6): TaskKilled (another attempt succeeded)
[Stage 13:===================================================> (353 + 12) / 360]2018-04-14 09:47:43 WARN  TaskSetManager:66 - Lost task 251.1 in stage 13.0 (TID 3322, 10.140.0.4, executor 9): TaskKilled (another attempt succeeded)
[Stage 13:====================================================>(354 + 11) / 360]2018-04-14 09:48:26 WARN  TaskSetManager:66 - Lost task 254.1 in stage 13.0 (TID 3327, 10.140.0.5, executor 12): TaskKilled (another attempt succeeded)
[Stage 13:====================================================>(355 + 11) / 360]2018-04-14 09:48:56 WARN  TaskSetManager:66 - Lost task 255.1 in stage 13.0 (TID 3328, 10.140.0.5, executor 15): TaskKilled (another attempt succeeded)
[Stage 13:=====================================================>(356 + 9) / 360]2018-04-14 09:50:56 WARN  TaskSetManager:66 - Lost task 257.1 in stage 13.0 (TID 3329, 10.140.0.4, executor 11): TaskKilled (another attempt succeeded)
[Stage 13:=====================================================>(357 + 7) / 360]2018-04-14 09:51:20 WARN  TaskSetManager:66 - Lost task 259.1 in stage 13.0 (TID 3331, 10.140.0.7, executor 5): TaskKilled (another attempt succeeded)
[Stage 13:=====================================================>(359 + 4) / 360]2018-04-14 09:51:39 WARN  TaskSetManager:66 - Lost task 261.1 in stage 13.0 (TID 3333, 10.140.0.3, executor 1): TaskKilled (another attempt succeeded)
[Stage 13:=====================================================>(359 + 3) / 360]2018-04-14 09:51:42 WARN  TaskSetManager:66 - Lost task 258.1 in stage 13.0 (TID 3330, 10.140.0.4, executor 10): TaskKilled (another attempt succeeded)
[Stage 15:=======================================>                 (7 + 6) / 10]2018-04-14 09:52:51 WARN  TaskSetManager:66 - Lost task 3.1 in stage 15.0 (TID 3355, 10.140.0.3, executor 2): TaskKilled (another attempt succeeded)
2018-04-14 09:52:51 WARN  TaskSetManager:66 - Lost task 1.1 in stage 15.0 (TID 3354, 10.140.0.7, executor 6): TaskKilled (another attempt succeeded)

scala> 

scala> //计算最高的推荐项

scala> //计算置信度最高的规则，置信度相同则合并

scala> val bestRules = rulesList.map(rule => (rule._1, rule._2.reduceLeft((a, b) => if(a._2 > b._2) a else if(a._2 == b._2) (a._1 ++ b._1, a._2) else b)))
bestRules: org.apache.spark.rdd.RDD[(scala.collection.immutable.Set[Int], (Array[Int], Double))] = MapPartitionsRDD[35] at map at <console>:27

scala> bestRules.cache()
2018-04-14 09:52:52 WARN  TaskSetManager:66 - Lost task 8.0 in stage 15.0 (TID 3352, 10.140.0.4, executor 9): TaskKilled (another attempt succeeded)
res5: bestRules.type = MapPartitionsRDD[35] at map at <console>:27

scala> //保存关联规则中置信度最高的

scala> bestRules.map(rule => rule._1.mkString("[", ",", "]") + " --> " + rule._2._1.mkString("[", ",", "]") + " : " + rule._2._2).saveAsTextFile(outputUrl + "bestRules") 
                                                                                
scala> //收集，用于遍历

scala> val rules = bestRules.collect()
2018-04-14 09:52:54 WARN  TaskSetManager:66 - Lost task 2.0 in stage 20.0 (TID 3359, 10.140.0.7, executor 6): TaskKilled (another attempt succeeded)
2018-04-14 09:52:54 WARN  TaskSetManager:66 - Lost task 1.0 in stage 20.0 (TID 3358, 10.140.0.5, executor 13): TaskKilled (another attempt succeeded)
2018-04-14 09:52:54 WARN  TaskSetManager:66 - Lost task 7.0 in stage 20.0 (TID 3364, 10.140.0.7, executor 4): TaskKilled (another attempt succeeded)
rules: Array[(scala.collection.immutable.Set[Int], (Array[Int], Double))] = Array((Set(406, 379, 124, 8),(Array(122),0.9992690363811035)), (Set(468, 121, 124, 81, 171, 122),(Array(8),0.998973635255629)), (Set(14, 514, 60, 124, 49, 516, 51, 122),(Array(8),0.9995567350369291)), (Set(121, 84, 6, 81, 516, 8, 122),(Array(49),0.9943270660397544)), (Set(476, 158, 49),(Array(122),0.9913777810974073)), (Set(511, 1, 60, 124, 8),(Array(122),0.9998638615157449)), (Set(519, 60, 878, 8),(Array(122),0.9994455787571368)), (Set(121, 60, 9, 124, 476, 49),(Array(122),0.9999181698093357)), (Set(121, 84, 149, 51, 122),(Array(8),0.9977932552542204)), (Set(121, 22, 49, 516, 171, 8, 146, 51, 122),(Array(124),0.9325495178389186)), (Set(878, 49, 81, 863, 8),(Array(122),0.9989400803487477)), (Set(14, 514, 49, 171...
scala> 

scala> 

scala> //计算用户推荐项

scala> val userRecItems = usrSet.map(uSet => (rules.filter(x => x._1.subsetOf(uSet)).map(x => (x._2._1.toSet, x._2._2)), uSet)).map(u => if(u._1.isEmpty) (Set(), u._2) else (u._1.reduce((x, y) => if(x._2 > y._2) x else if (x._2 == y._2) (x._1 ++ y._1, x._2) else y)._1.filter(x => !u._2.contains(x)), u._2))
userRecItems: org.apache.spark.rdd.RDD[(scala.collection.immutable.Set[_ <: Int], scala.collection.immutable.Set[Int])] = MapPartitionsRDD[39] at map at <console>:29

scala> 

scala> //计算用户推荐项

scala> //    val userRecItems = userArray.map(oneUser => (rules.filter(x => x._1.subsetOf(oneUser.toSet)).map(x => x._2._1).flatMap(f => f).distinct.filter(e => !oneUser.contains(e)), oneUser))

scala> userRecItems.cache()
res7: userRecItems.type = MapPartitionsRDD[39] at map at <console>:29

scala> //保存格式化

scala> val result = userRecItems.map(item => (item._1.mkString("[", ",", "]")))
result: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[40] at map at <console>:27

scala> result.cache()
res8: result.type = MapPartitionsRDD[40] at map at <console>:27

scala> result.saveAsTextFile(outputUrl+"userRecItemsCom")
[Stage 26:>                                                       (0 + 1) / 360]2018-04-14 09:53:02 WARN  TaskSetManager:66 - Lost task 260.1 in stage 13.0 (TID 3332, 10.140.0.7, executor 7): TaskKilled (another attempt succeeded)
[Stage 26:===========>                                          (74 + 20) / 360]packet_write_wait: Connection to 35.201.136.180 port 22: Broken pipe
yuehui@master:~$ 
                                                                                                                                                                                                                                             
